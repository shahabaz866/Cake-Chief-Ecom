{% extends "user_side/base.html" %}
{% block content %} 
{% load static %} 
{% load temp_tags %} 
    {% block extra_css %}
    <style>
      /* Enhanced Product Details Styling */
      .product-section {
        padding: 4rem 0;
        background-color: #ffffff;
      }
    
      .product-gallery {
        position: relative;
        padding: 1rem;
        background-color: #ffffff;
        border-radius: 12px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      }
    
      /* Main Image Styles */
      .main-image-container {
        position: relative;
        width: 100%;
        margin-bottom: 1.5rem;
        border-radius: 8px;
        overflow: hidden;
      }
    
      .main-image-wrapper {
        position: relative;
        width: 100%;
        padding-top: 100%; /* 1:1 Aspect Ratio */
        overflow: hidden;
      }
    
      .main-image {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: 8px;
        transition: transform 0.3s ease;
      }
    
      .image-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0);
        transition: background 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        opacity: 0;
      }
    
      .main-image-wrapper:hover .image-overlay {
        background: rgba(0, 0, 0, 0.2);
        opacity: 1;
      }
    
      {% comment %} .zoom-button {
        background: white;
        border: none;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: transform 0.3s ease;
      }
    
      .zoom-button:hover {
        transform: scale(1.1);
      }
     {% endcomment %}


     
     {% comment %} zoom {% endcomment %}
     .main-image {
        width: 100%;
        height: auto;
        transition: transform 0.3s ease;
        
    }

    .main-image.zoomed {
        transform: scale(1.5);
    
    }


      /* Thumbnail Navigation Styles */
      .thumbnail-navigation {
        position: relative;
        display: flex;
        align-items: center;
        gap: 1rem;
        margin-top: 1rem;
      }
    
      .thumbnails-container {
        flex: 1;
        overflow: hidden;
      }
    
      .thumbnails-wrapper {
        display: flex;
        gap: 1rem;
        transition: transform 0.3s ease;
      }
    
      .thumbnail-item {
        flex: 0 0 calc(25% - 0.75rem);
        position: relative;
        padding-top: calc(25% - 0.75rem);
        cursor: pointer;
        border-radius: 6px;
        overflow: hidden;
      }
    
      .thumbnail-item img {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: 6px;
        border: 2px solid transparent;
        transition: all 0.3s ease;
      }
    
      .thumbnail-item.active img {
        border-color: #e74c3c;
      }
    
      .thumbnail-item:hover img {
        transform: scale(1.05);
      }
    
      .nav-button {
        background: white;
        border: none;
        border-radius: 50%;
        width: 36px;
        height: 36px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
      }
    
      .nav-button:hover {
        background: #f8f9fa;
        transform: scale(1.1);
      }
    
      .nav-button i {
        color: #2c3e50;
      }
    
      .image-modal {
        display: none; /* Hidden by default */
        position: fixed;
        z-index: 9999;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0, 0, 0, 0.7); /* Black with opacity */
        justify-content: center;
        align-items: center;
      }
    
      .modal-content {
        max-width: 90%;
        max-height: 90%;
      }
    
      .close-modal {
        position: absolute;
        top: 15px;
        right: 35px;
        color: #f1f1f1;
        font-size: 40px;
        font-weight: bold;
        cursor: pointer;
      }
    
      /* Responsive Adjustments */
      @media (max-width: 768px) {
        .thumbnail-item {
          flex: 0 0 calc(33.333% - 0.667rem);
          padding-top: calc(33.333% - 0.667rem);
        }
      }
    
      @media (max-width: 576px) {
        .thumbnail-item {
          flex: 0 0 calc(50% - 0.5rem);
          padding-top: calc(50% - 0.5rem);
        }
      }
    
      .product-info {
        padding: 2rem;
        background-color: #fff;
        border-radius: 10px;
        box-shadow: 0 2px 15px rgba(0, 0, 0, 0.05);
      }
    
      .product-title {
        color: #2c3e50;
        font-size: 2.5rem;
        margin-bottom: 1rem;
        font-family: "Playfair Display", serif;
      }
    
      .product-badges .badge {
        font-size: 0.9rem;
        padding: 0.5rem 1rem;
        border-radius: 20px;
      }
    
      .product-rating {
        display: flex;
        align-items: center;
        gap: 10px;
      }
    
      .stars {
        color: #ffd700;
      }
    
      .product-price {
        font-size: 2rem;
        color: #e74c3c;
        font-weight: 600;
      }
    
      .serving-info {
        font-size: 1rem;
        margin-left: 10px;
      }
    
      .cake-specs {
        background-color: #f8f9fa;
        padding: 1.5rem;
        border-radius: 8px;
        margin-bottom: 2rem;
      }
    
      .spec-item {
        display: flex;
        align-items: center;
        margin-bottom: 1rem;
        gap: 10px;
      }
    
      .spec-item i {
        color: #e74c3c;
        font-size: 1.2rem;
      }
    
      .section-title {
        font-size: 1.5rem;
        color: #2c3e50;
        margin-bottom: 1rem;
        font-family: "Playfair Display", serif;
      }
    
      .dietary-icons {
        display: flex;
        gap: 15px;
        margin-bottom: 1rem;
      }
    
      .dietary-item {
        font-size: 1.5rem;
        color: #27ae60;
      }
    
      .quantity-selector .form-control {
        max-width: 80px;
      }
    
      .add-to-cart {
        background-color: #e74c3c;
        border-color: #e74c3c;
        transition: all 0.3s ease;
      }
    
      .add-to-cart:hover {
        background-color: #c0392b;
        border-color: #c0392b;
      }
    
      .accordion-button:not(.collapsed) {
        background-color: #f8f9fa;
        color: #e74c3c;
      }
    
      .accordion-button:focus {
        box-shadow: none;
        border-color: rgba(231, 76, 60, 0.25);
      }
    
      .btn-group .btn-outline-primary {
        color: #e74c3c;
        border-color: #e74c3c;
      }
    
      .btn-group .btn-outline-primary:hover,
      .btn-group .btn-check:checked + .btn-outline-primary {
        background-color: #e74c3c;
        border-color: #e74c3c;
        color: white;
      }
    </style>
    {% endblock %}
    
    <div class="product-section">
      <div class="container">
        <div class="row">
          <!-- Product Gallery Section -->
            <div class="col-lg-6">
              <div class="product-gallery">
                <div class="main-image-container">
                  <div class="main-image-wrapper">
                    <div class="zoom-container" id="zoomContainer">
                      <img
                        id="mainImage"
                        src="{{ product.image.url }}"
                        alt="{{ product.title }}"
                        class="main-image"
                      />
                    </div>
                  </div>
                </div>
                
        
                <!-- Thumbnail Navigation -->
                <div class="thumbnail-navigation">
                    <button
                    class="nav-button prev-button"
                    onclick="slideImages('prev')"
                    >
                    <i class="fas fa-chevron-left"></i>
                    </button>
        
                    <div class="thumbnails-container">
                    <div class="thumbnails-wrapper">
                        <!-- Main Product Image Thumbnail -->
                        <div
                        class="thumbnail-item {% if forloop.first %}active{% endif %}"
                        >
                        <img
                            src="{{ product.image.url }}"
                            alt="{{ product.title }}"
                            onclick="changeMainImage('{{ product.image.url }}', this)"
                        />
                        </div>
        
                        <!-- Additional Images Thumbnails -->
                        {% for imag in aditional_img %}
                        <div class="thumbnail-item">
                        <img
                            src="{{ imag.image.url }}"
                            alt="Additional image for {{ product.title }}"
                            onclick="changeMainImage('{{ imag.image.url }}', this)"
                        />
                        </div>
                        {% endfor %}
                    </div>
                    </div>
        
                    <button
                    class="nav-button next-button"
                    onclick="slideImages('next')"
                    >
                    <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
                </div>
        
                
            </div>
        
            <!-- Product Information -->
            <div class="col-lg-6">
                <div class="product-info">
                <h1 class="product-title">{{ product.title }}</h1>
        
                <div class="product-badges mb-3">
                    <!-- Bestseller Badge -->
                    {% if product.is_bestseller %}
                    <span class="badge bg-warning text-dark me-2">Bestseller</span>
                    {% endif %}
        
                    <!-- New Flavor Badge -->
                    {% if product.is_new %}
                    <span class="badge bg-success me-2">New Flavor</span>
                    {% endif %} {% if product.stock <= 0 %}
                    <span class="badge bg-danger me-2">Out of Stock</span>
        
                    {% else %}
                    <span class="badge bg-success me-2">In Stock</span>
        
                    {% endif %}
        
                    <!-- Dietary Info Badge -->
                    {% if product.dietary_info %}
                    <span class="badge bg-info text-dark me-2"
                    >{{ product.dietary_info }}</span
                    >
                    {% endif %}
                </div>
        
                <div class="product-price mb-4">
                    <span class="current-price">â‚¹{{ product.price }}</span>
                    <span class="serving-info text-muted">( 400-g )</span>
                </div>
        
                <div class="product-description mb-4">{{ product.description }}</div>
        
                <!-- Cake Specifications -->
                <div class="cake-specs mb-4">
                    <div class="spec-item">
                    <i class="fas fa-birthday-cake"></i>
                    <span class="spec-label">Base Flavor:</span>
                    <span class="spec-value">{{ product.flavour }}</span>
                    </div>
                    <div class="spec-item">
                    <i class="fas fa-heart"></i>
                    <span class="spec-label">Base category:</span>
                    <span class="spec-value">{{ product.category }}</span>
                    </div>
                    <div class="spec-item">
                    <i class="fas fa-layer-group"></i>
                    <span class="spec-label">Layers:</span>
                    <span class="spec-value">{{ product.layers }}</span>
                    </div>
                    <div class="spec-item">
                    <i class="fas fa-clock"></i>
                    <span class="spec-label">Preparation Time:</span>
                    <span class="spec-value">{{ product.created_at }}</span>
                    </div>
                    <div class="spec-item">
                    <i class="fas fa-snowflake"></i>
                    <span class="spec-label">Storage:</span>
                    <span class="spec-value">{{ product.storage_info }}</span>
                    </div>
                </div>
        
                <!-- Customization Options -->
                <div class="customization-section mb-4">
                    <h3 class="section-title">Customize Your Cake</h3>
        
                    <!-- Size Selection -->
                    <div class="size-selection mb-3">
                    <label class="form-label">Select Size:</label>
                    <div class="btn-group" role="group">
                        {% for size in product.sizes %}
                        <input
                        type="radio"
                        class="btn-check"
                        name="size"
                        id="size{{ forloop.counter }}"
                        value="{{ size.value }}"
                        {%
                        if
                        forloop.first
                        %}checked{%
                        endif
                        %}
                        />
                        <label
                        class="btn btn-outline-primary"
                        for="size{{ forloop.counter }}"
                        >
                        {{ size.name }}
                        </label>
                        {% endfor %}
                    </div>
                    </div>
        
                    <!-- Message on Cake -->
                    <div class="cake-message mb-4">
                    <label class="form-label">Message on Cake (Optional):</label>
                    <input
                        type="text"
                        class="form-control"
                        placeholder="Happy Birthday!"
                        maxlength="50"
                    />
                    <small class="text-muted">Maximum 50 characters</small>
                    </div>
                </div>
        
                <!-- Ordering Section -->
                <div class="ordering-section mb-4">
                    <div class="quantity-selector mb-3">
                    <label class="form-label">Quantity:</label>
                    <div class="input-group">
                        <button
                        class="btn btn-outline-secondary"
                        onclick="decrementQuantity()"
                        >
                        <i class="fas fa-minus"></i>
                        </button>
                        <input
                        type="number"
                        class="form-control text-center quantity-input"
                        value="1"
                        min="1"
                        max="10"
                        />
                        <button
                        class="btn btn-outline-secondary"
                        onclick="incrementQuantity()"
                        >
                        <i class="fas fa-plus"></i>
                        </button>
                    </div>
                    </div>
        
                    <div class="action-buttons">
                    <button class="btn btn-primary btn-lg add-to-cart w-75">
                        <i class="fas fa-shopping-cart me-2"></i>Add to Cart
                    </button>
                    <button class="btn btn-outline-danger btn-lg wishlist-btn">
                        <i class="far fa-heart"></i>
                    </button>
                    </div>
                </div>
        
                <!-- Additional Information -->
                </div>
            </div>
        </div>
      </div>
    </div>
    
    <script>
      function updateMainImage(src) {
        document.querySelector(".main-image img").src = src;
      }
    
      function incrementQuantity() {
        const input = document.querySelector(".quantity-input");
        input.value = parseInt(input.value) + 1;
      }
    
      function decrementQuantity() {
        const input = document.querySelector(".quantity-input");
        if (parseInt(input.value) > 1) {
          input.value = parseInt(input.value) - 1;
        }
      }
    </script>
    <script>
      // Change Main Image Function
      function changeMainImage(src, thumbnailElement) {
        const mainImage = document.getElementById("mainImage");
        mainImage.src = src;
    
        // Update active thumbnail
        document.querySelectorAll(".thumbnail-item").forEach((item) => {
          item.classList.remove("active");
        });
        thumbnailElement.parentElement.classList.add("active");
      }
    
      // Thumbnail Navigation
      let currentPosition = 0;
      const thumbnailsWrapper = document.querySelector(".thumbnails-wrapper");
      const thumbnails = document.querySelectorAll(".thumbnail-item");
      const itemWidth = thumbnails[0].offsetWidth + 16; // Including gap
    
      function slideImages(direction) {
        const maxScroll =
          thumbnails.length * itemWidth - thumbnailsWrapper.offsetWidth;
    
        if (direction === "next" && currentPosition > -maxScroll) {
          currentPosition -= itemWidth;
        } else if (direction === "prev" && currentPosition < 0) {
          currentPosition += itemWidth;
        }
    
        thumbnailsWrapper.style.transform = `translateX(${currentPosition}px)`;
      }
    
      document.addEventListener("DOMContentLoaded", function () {
        const modal = document.getElementById("imageModal");
        const modalImg = document.getElementById("modalImage");
      
        const closeButton = document.querySelector(".close-modal");
    
        // Open Modal on Zoom Button Click
        {% comment %} zoomButton.onclick = function () {
          modal.style.display = "flex";
          modalImg.src = document.getElementById("mainImage").src;
        }; {% endcomment %}
    
        // Close Modal on X Button Click
        closeButton.onclick = function () {
          modal.style.display = "none";
        };
    
        // Close Modal on Outside Click
        modal.onclick = function (e) {
          if (e.target === modal) {
            modal.style.display = "none";
          }
        };
      });
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const images = document.querySelectorAll('.main-image');

            images.forEach(image => {
                image.addEventListener('mouseover', () => {
                    image.classList.add('zoomed');
                });

                image.addEventListener('mouseout', () => {
                    image.classList.remove('zoomed');
                });
            });
        });


    </script>
    <script src="https://cdn.jsdelivr.net/jquery.elevatezoom/3.0.8/jquery.elevatezoom.min.js"></script>
<script>
    $(document).ready(function(){
        $('#product-image').elevateZoom({
            zoomType: "lens",
            lensShape: "round",
            lensSize: 200
        });
    });
</script>
    {% endblock %}
    